<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Редактор</title>
    <link rel="icon" href="https://raw.githubusercontent.com/htmlcssphpjs/image/main/icon.ico">
    <link rel="stylesheet" href="dist/codemirror.css">
    <script src="dist/codemirror.js"></script>
    <script src="dist/xml.js"></script>
  </head>
  <body class="body1">
    <button class="run" id="run" onclick="runing()" style="margin-bottom: 2px;margin-top: -2px;margin-left: -4px;">ЗАПУСК</button>
    <button onclick="download()" style="position: fixed;top: 5px;right: 5px;" class="run">СКАЧАТЬ</button>
    <textarea id="code" name="code">
<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Документ</title>
<style></style>
</head>
<body>
  <h1>Заголовок</h1>
  <p>Параграф</p>
</body>
</html></textarea>
  <bt>
    <div class="menu">
      <b class="btest"><</b>
      <b class="btest">></b>
      <mtxt><b class="loc">localhost:1500</b></mtxt>
      <img src="img/reload.png" class="reload123" onclick="runing()">
    </div>
    <browser id="play">
      <div class="start">
        <img src="img/icon.png" style="width: 50%;">
        <h2>Запустите код</h2>
      </div>
    </browser>
  </bt>
  <script>
    var editor = CodeMirror.fromTextArea(document.getElementById('code'), { mode: 'xml', lineNumbers: false })
    var code = document.querySelector(".CodeMirror-code");
    var run = document.getElementById("run");
    var play = document.getElementById("play");
    var coding = code.innerText;
    console.log("Ctrl + P -- запустить код;\nCtrl + S -- скачать html файл;");
    function runing () {
      coding = editor.getValue();
      document.getElementById('play').innerHTML = coding;
    }
    const download = () => {
      let text = editor.getValue() + "\n<!--//vsevolodhtml-->"
      let blob = new Blob([text], {
        type: 'text/plain'
      })
      let anchor = document.createElement('a')
      anchor.download = 'project.html'
      anchor.href = window.URL.createObjectURL(blob)
      anchor.target = '_blank'
      anchor.style.display = 'none'
      document.body.appendChild(anchor)
      anchor.click()
      document.body.removeChild(anchor)
      alert("Всеволод html")
    }
    document.addEventListener('keydown', function(event) {
      if (event.code == 'KeyS' && (event.ctrlKey || event.metaKey)) {
        download();
      } else if (event.code == 'KeyP' && (event.ctrlKey || event.metaKey)) {
        runing();
      }
    });
  </script>
  <style>
    * {box-sizing: border-box;}
    .body1 {
      background: #282923;
      overflow: hidden;
    }
    bt, #code {
      width: 49%;
      margin: 0 auto;
      display: inline-block;
      height: 500px;
      margin-left: 100px;
    }
    .run {
      display: block;
    }
    .run {
      font-weight: 700;
      color: #E7DB74;
      text-decoration: none;
      padding: .8em 1em calc(.8em + 3px);
      border-radius: 3px;
      background: #42433E;
      box-shadow: 0 -3px #42433E inset;
      transition: 0.2s;
    } 
    .run:hover { background: #282923; }
    .run:active {
      background: #282923;
      box-shadow: 0 3px #282923 inset;
    }
    bt {
      background-color: white;
      position: absolute;
      margin-left: 10px;
      overflow: auto;
      resize: both;
    }
    .start {text-align: center;margin-top: 10%}
    .menu {font-size: 30px;background: #42433E;color: white;}
    .btest {margin-left: 10px;cursor: pointer;}
    mtxt {
      display: block;
      margin-left: 20px;
      font-size: 15px; 
      padding: 5px;
      background: white;
      color: black;
      border: 2px solid #42433E;
      width: 50%;
      margin-top: -32px;
      margin-left: 70px;
    }
    .loc {
      margin-top: -10px;
    }
    .reload123 {
      width: 25px;
      filter: invert(1);
      top: 2px;
      left: 90%;
      position: absolute;
      transition: 1s;
      cursor: pointer;
    }
    .reload123:active {
      transform: rotate(-360deg);
    }
  </style>
  <style>.CodeMirror, .cm-s-default {width: 49%;display: inline-block;height: 500px;}</style>
  </body>
</html>
